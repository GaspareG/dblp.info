<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="DBLP Data visualization">
    <meta name="author" content="Gaspare Ferraro">
    <meta name="theme-color" content="#343a40">

    <title>dblp.info</title>

    <link rel="canonical" href="http://dblp.info">

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/heroic-features.css" rel="stylesheet">

    <link rel="stylesheet" href="http://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  
    <style type="text/css">
      svg {
        font: 10px sans-serif;
        shape-rendering: crispEdges;
      }

      .filter {
        margin: 16px;
        padding: 16px;
        border: 1px black solid;
      }

      .line {
        /*fill: none;*/
        /*stroke: steelblue;*/
        stroke-width: 2px;
      }

    </style>

  </head>

  <body>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
      <div class="container">
        <a class="navbar-brand" href="/">dblp.info</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link" href="/">Home</a>
            </li>
            <li class="nav-item active">
              <a class="nav-link" href="/authors">Authors</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/papers">Papers</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/journals">Journals</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/coauthorship">Coauthorship</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Page Content -->
    <div class="container">

      <!-- Jumbotron Header -->
      <header class="jumbotron my-4">

        <h3>Authors visualization</h3>

        <!-- Search author -->
        <div class="ui-widget">
          <label for="authors">Search author: </label>
          <input id="author">
          (<a href="authors_list">complete authors list</a>)
         </div>

        <!-- Info -->
        <br/>
        <div id="author-info" style="margin: auto; text-align: center;"></div>

        <!-- Plot -->
        <div id="data-container" style="margin: auto; text-align: center;"></div>

        <!-- Plot type -->
        <div class="filter">
          <fieldset>
            <legend>Chart type</legend>

              <div>
                <input type="radio" id="stacked" name="chart" checked />
                <label for="stacked">Stacked bar chart</label>
              </div>
              <div>
                <input type="radio" id="lines" name="chart"/>
                <label for="lines">Lines chart</label>
              </div>
              <div>
                <input type="radio" id="pie-year" name="chart"/>
                <label for="pie-year">Pie chart per year</label>
              </div>
              <div>
                <input type="radio" id="pie-journal" name="chart"/>
                <label for="pie-journal">Pie chart per journals</label>
              </div>

            </fieldset>
        </div>

        <!-- Year controls-->
        <div class="filter">
          <div id="slider-text"></div>
          <br/>
          <div id="slider-range"></div>
        </div>

        <!-- Cluster years controls-->
        <div class="filter">
          <div id="cluster-text"></div>
          <br/>
          <div id="cluster-range"></div>
        </div>

        <!-- Venue controls --> 
        <div id="checkbox-container" class="filter"></div>

        <!-- Co-Authors controls -->
        <div id="checkbox-coauthor" class="filter" style="max-height: 300px; overflow-y: scroll"></div>

        <!-- Timeline -->
        <br/>
        <a name="timeline"></a> 
        <h3 style="margin: auto; text-align: center;">Author timeline</h3>
        <h5 style="margin: auto; text-align: center;">top-25 Co-Authors</h5>
        <br/>
        <div id="timeline-container" style="margin: auto; text-align: center;"></div>

        <!-- Plot type -->
        <div class="filter">
          <fieldset>
            <legend>Group by</legend>

              <div>
                <input type="radio" id="group-years" name="group" checked/>
                <label for="group-years">Years</label>
              </div>

              <div>
                <input type="radio" id="group-papers" name="group"/>
                <label for="gruop-papers">Papers</label>
              </div>

            </fieldset>
        </div>

        <!-- Cluster years controls-->
        <div class="filter">
          <div id="start-text"></div>
          <br/>
          <div id="start-range"></div>
        </div>

      </header>

      <!-- /.row -->

    </div>
    <!-- /.container -->

    <!-- Footer -->
    <footer class="py-5 bg-dark">
      <div class="container">
          <p class="m-0 text-center text-white"> Gaspare Ferraro @ <a href="https://gaspa.re">gaspa.re</a> </p>
          <p class="m-0 text-center text-white"> Source code @ <a href="https://github.com/GaspareG/dblp.info">github.com</a> </p>
          <p class="m-0 text-center text-white"> Dataset @ <a href="https://dblp.uni-trier.de">dblp.uni-trier.de</a> </p>
      </div>
      <!-- /.container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <script src="script/jquery.min.js"></script>
    <script src="script/bootstrap.bundle.min.js"></script>
    <script src="script/d3.v5.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  
    <script type="text/javascript">

      var chartType = 0;
      var timelineType = 0;
      var selectedId = 0;
      var authors = [];
      var a2i = {};
      var names = [];

      $("#stacked").on("change", function(){
        chartType = 0;
        plot();
      });
      $("#lines").on("change", function(){
        chartType = 1;
        plot();
      });

      $("#pie-year").on("change", function(){
        chartType = 2;
        plot();
      });

      $("#pie-journal").on("change", function(){
        chartType = 3;
        plot();
      });

      $("#group-years").on("change", function(){
        timelineType = 0;
        plotTimeline();
      });

      $("#group-papers").on("change", function(){
        timelineType = 1;
        plotTimeline();
      });
        
      function updateQueryStringParam(key, value) {
        baseUrl = [location.protocol, '//', location.host, location.pathname].join('');
        urlQueryString = document.location.search;
        var newParam = key + '=' + value,
        params = '?' + newParam;

        if (urlQueryString) {
          keyRegex = new RegExp('([\?&])' + key + '[^&]*');
          if (urlQueryString.match(keyRegex) !== null) {
            params = urlQueryString.replace(keyRegex, "$1" + newParam);
          } else { // Otherwise, add it to end of query string
            params = urlQueryString + '&' + newParam;
          }
        }
        window.history.replaceState({}, "", baseUrl + params);
      }

      function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split('&');
        for (var i = 0; i < vars.length; i++) {
          var pair = vars[i].split('=');
          if (decodeURIComponent(pair[0]) == variable) {
            return decodeURIComponent(pair[1]);
          }
        }
        return undefined;
      }

      $(document).ready(function(){
        loadAuthors();
        if( getQueryVariable("id") != undefined )
          loadAuthorData( getQueryVariable("id") );
      });

      function loadAuthors()
      {
        d3.csv("data/authors.csv", function(d){
          return [parseInt(d["id"]), d["name"]];
        }).then(function(data){
          authors = data;

          for(var i=0; i < data.length; i++)
            a2i[ data[i][1] ] = data[i][0];

          for(var i=0; i < data.length; i++)
            names.push(data[i][1]);

          loadAutocomplete();
        });
      }

      function loadAutocomplete()
      {
    
        $( "#author" ).autocomplete({
          source: names,
          minLength: 3,
          autoFocus: true,
          select: function( event, ui ) {
            if( ui.item.value == undefined ) return alert("Error loading data!");
            var id = a2i[ui.item.value];
            if( id == undefined ) return alert("Error loading data!");
            loadAuthorData(id);
          }
        });
      }


      var wrote = [];
      var wroteAuthor = [];
      var p2w = [];
      function loadAuthorData(id)
      {
        selectedId = id;
        updateQueryStringParam("id", id);

        d3.csv("data/wrote.csv", function(d){
          return [parseInt(d["idA"]), parseInt(d["idP"]) ];
        }).then(function(data){

          wrote = data; 
          wroteAuthor = [];
          p2w = [];

          for(var i=0; i < data.length; i++)
            if( data[i][0] == id )
              wroteAuthor.push( data[i][1] );

          for(var i=0; i < data.length; i++)
          {  
            if( p2w[ data[i][1] ] == undefined )
              p2w[ data[i][1] ] = [];
            p2w[ data[i][1] ].push( data[i][0] );
          }

          loadPapers();
        });
      }

      var papers = [];
      function loadPapers()
      {
        papers = [];
        d3.csv("data/papers.csv", function(d){
          var id = parseInt(d["id"]);
          var tag = d["tag"];
          var title = d["title"];
          var year = parseInt(d["year"]);
          return [id, tag.split("/")[1], tag.split("/")[2], title, year];
        }).then(function(data)
        {
          papers = data;
          loadVenues();          
        });
      }


      var venues = [];
      var venuesName = [];
      var venuesCheck = [];
    
      function loadVenues()
      {
        venues = [];
        venuesName = [];
        venuesCheck = [];
    
        d3.csv("data/journals.csv", function(d){
          var id = parseInt(d["id"]);
          var tag = d["tag"];
          var title = d["name"];
          return [id, tag, title];
        }).then(function(data){
          for(var i=0; i < data.length; i++)
          {          
            venues.push(data[i][1]);
            venuesName.push(data[i][2]);
            venuesCheck.push(true);
          }
          loadControls();
        });
      }
      

      function loadControls()
      {
        loadSlider();
        loadCluster();
        loadCheckbox();
        loadCoauthor();
        loadStartSlider();
        printInfo();
        plot();
        plotTimeline();
      }

      function printInfo()
      {
        $("#author-info").html("");
  
        var title = $("<h3>"+authors[selectedId][1]+" (id "+authors[selectedId][0]+")</h3>");

        var active_years = $("<div>Active from year <b>"+minYear+"</b> to year <b>"+maxYear+"</b></div>");
        var npapers = $("<div>Has wrote <b>"+wroteAuthor.length+" papers</b> (in computer graphics venues)</div>");
        var coauth = $("<div>together with <b>"+Object.keys(coauthors).length+" co-authors</b></div>");
        var timeline = $("<div>See author <a href='#timeline'>timeline</a></div>");
        var papers = $("<div>See author <a href='papers?id="+selectedId+"'>papers</a> (TODO)</div>");
        var coauthorship = $("<div>See co-authorship <a href='coauthorship?id="+selectedId+"'>graph</a> (TODO)</div>");

        $("#author-info").append(title);
        $("#author-info").append(active_years);
        $("#author-info").append(npapers);
        $("#author-info").append(coauth);
        $("#author-info").append(timeline);
        $("#author-info").append(papers);
        $("#author-info").append(coauthorship);

      }

      var minYear = 3000;
      var maxYear = 0;

      function loadSlider()
      {

        minYear = 3000;
        maxYear = 0;

        for(var i=0; i < wroteAuthor.length; i++) minYear = Math.min(minYear, papers[wroteAuthor[i]][4] );
        for(var i=0; i < wroteAuthor.length; i++) maxYear = Math.max(maxYear, papers[wroteAuthor[i]][4] );

        $("#slider-text").html("<b>Year: " + minYear + " - " + maxYear+"</b>");
        $("#slider-range" ).slider({
          range: true,
          min: minYear,
          max: maxYear,
          values: [ minYear, maxYear ],
          slide: function( event, ui ) {
            minYear = ui.values[ 0 ];
            maxYear = ui.values[ 1 ];
            $("#slider-text").html("<b>Year: " + minYear + " - " + maxYear+"</b>");
            plot();
          }
        });
      }


      
      var startTimeline = 0;
      var endTimeline = 0;
      function loadStartSlider()
      {

        startTimeline = 0;
        endTimeline = wroteAuthor.length;

        $("#start-text").html("Selected papers: <b>"+startTimeline+"<sup>th</sup></b> -  <b>"+endTimeline+"<sup>th</sup></b> ");
        $("#start-range").slider({
          range: true,
          min: 0,
          max: wroteAuthor.length,
          values: [startTimeline, endTimeline],
          slide: function( event, ui ) {
            startTimeline = ui.values[0];
            endTimeline = ui.values[1];
            $("#start-text").html("Selected papers: <b>"+startTimeline+"<sup>th</sup></b> -  <b>"+endTimeline+"<sup>th</sup></b> ");
            plotTimeline();
          }
        });
      }

      var clusterYear = 1;

      function loadCluster()
      {

        $("#cluster-text").html("<b>Cluster year: "+clusterYear+" (TODO) </b>");
        $("#cluster-range" ).slider({
          range: false,
          min: 1,
          max: 50,
          value: clusterYear,
          slide: function( event, ui ) {
            clusterYear = ui.value;
            $("#cluster-text").html("<b>Cluster year: "+clusterYear+" (TODO) </b>");
            // plot();
          }
        });
      }


      function loadCheckbox()
      {
        $("#checkbox-container").html("");
        $("#checkbox-container").append("<b>Journals:</b>");

        for(var i=0; i < venues.length; i++)
        {
          var label = $("<label id='"+venues[i]+"'></label>");
          var checkbox = $("<input type='checkbox' checked name='"+venues[i]+"'/>");
          var title = $("<span> "+venuesName[i]+" ("+venues[i]+")</span>");

          label.append(checkbox);
          label.append(title);

          checkbox.on("change", function(){
            var name = $(this).attr("name");
            venuesCheck[ venues.indexOf(name) ] = this.checked;
            plot();
          });

          $("#checkbox-container").append("<br/>");
          $("#checkbox-container").append(label);
        }
      }

      var coauthors = {};

      function loadCoauthor()
      {
        coauthors = {};
        for(var i=0; i < wroteAuthor.length; i++)
        {
          var id = wroteAuthor[i];
          for(var j=0; j < p2w[id].length; j++)
            coauthors[ p2w[id][j] ] = true;
        }

        delete coauthors[selectedId];

        $("#checkbox-coauthor").html("");
        $("#checkbox-coauthor").append("<b>Co-Authors:</b>");

        for(var k in coauthors)
        {
          var label = $("<label></label>");
          var checkbox = $("<input type='checkbox' checked name='"+k+"'/>");
          var title = $("<span> "+authors[k][1]+" ("+k+")</span>");

          label.append(checkbox);
          label.append(title);

          checkbox.on("change", function(){
            var name = $(this).attr("name");
            coauthors[ name ] = this.checked;
            plot();
          });

          $("#checkbox-coauthor").append("<br/>");
          $("#checkbox-coauthor").append(label);
        }

      }


      function plot(){
        
        // CREATE DATA
        var data = [];
        for(var i=0; i < wroteAuthor.length; i++)
        {
          var paper = papers[wroteAuthor[i]];
          var year = paper[4];
          var venue = paper[1];
          var coauth = p2w[wroteAuthor[i]];
          if( !( minYear <= year && year <= maxYear ) ) continue;
          if( !venuesCheck[ venues.indexOf( venue ) ] ) continue;
          var filtro = true;
          for(var k=0; k < coauth.length; k++)
          {
            if( coauth[k] == selectedId ) continue
            filtro = filtro && coauthors[ coauth[k] ];
          }
          if( !filtro ) continue;
          data.push( [year, venue] ); 
        }

        var ret = {};

        for(var i=0; i < data.length; i++){
          // Creo l'anno
          if( ret[data[i][0]] == undefined ) ret[data[i][0]] = {};
          // Creo la venue
          if( ret[data[i][0]][data[i][1]] == undefined ) ret[data[i][0]][data[i][1]] = 0;
          // Incremento conteggio
          ret[data[i][0]][data[i][1]]++;
        }

        var ret2 = [];
        // Per ogni anno
        for(var y in ret)
        {
          for(var j = 0 ; j < venues.length; j++)
            if( ret[y][ venues[j] ] == undefined )
              ret[y][ venues[j] ] = 0;
          var v = [];
          for(var j = 0 ; j < venues.length; j++)
            v.push([ venues[j], venuesCheck[j] ? ret[y][ venues[j] ] : 0 ]);

          y = parseInt(y);
          if( minYear <= y && y <= maxYear )
            ret2.push( [y, v] );
        }
        
        data = ret2;

        data.sort( (a,b) => a[0] - b[0] );

        var margin = (chartType == 0 || chartType == 1 ) ? 
          {top: 35, right: 35, bottom: 35, left: 35} :
          {top: 0, right: 0, bottom: 0, left: 0};
        var width = 860 - margin.left - margin.right, height = 480 - margin.top - margin.bottom;

        d3.select("#data-container svg").remove();

        var svg = d3.select("#data-container")
          .append("svg")
          .attr("width", width + margin.left + margin.right)
          .attr("height", height + margin.top + margin.bottom)
          .append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        // X AXIS
        var x = d3.scaleBand().rangeRound([0, width]);
        var minX = data[0][0];
        var maxX = data[data.length-1][0];
        x.domain(d3.range(minX, maxX+1));

        // Y AXIS
        var y = d3.scaleLinear().range([height, 0]);
        var minY = 0;
        var maxY = d3.max(data, function(d){
          var t = 0;
          for(var i=0; i < d[1].length; i++)
            if( chartType == 0 ) t += d[1][i][1];
            else t = Math.max(t, d[1][i][1]);
          return t;
        });
        y.domain([minY, maxY+1]);

        // Z AXIS
        var z = d3.scaleOrdinal(d3.schemeCategory10);
        z.domain(venues);

        for(var i=0; i < venues.length; i++)
          $("#" + venues[i]).css("color", z(venues[i]) );

        if( chartType == 0 || chartType == 1 )
        {

        svg.append("g").call(d3.axisLeft(y));
        svg.append("g")
        .attr("class", "axis axis--x")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(x))
        .selectAll("text")
        .attr("y", 10)
        .attr("x", 10)
        .attr("dy", ".35em")
        .attr("transform", "rotate(45)")
        .style("text-anchor", "start");

        }

        if( chartType == 0 )
        {
          var stack = d3.stack()
          .keys( venues )
          .value(function(d, key){
            return d[1][ venues.indexOf(key) ][1];
          });

          svg.append("g")
          .selectAll("g")
          .data(stack(data))
          .enter().append("g")
          .attr("fill", function(d) { return z(d.key); })
          .selectAll("rect")
          .data(function(d) { return d; })
          .enter().append("rect")
          .attr("x", function(d) { return x(d.data[0]); })
          .attr("y", function(d) { return y(d[1]); })
          .attr("height", function(d) { return y(d[0]) - y(d[1]); })
          .attr("width", x.bandwidth());
        }
        else if( chartType == 1 )
        {

          var clip = svg.append("svg:clipPath")
                .attr("id", "clip")
                .append("svg:rect")
                .attr("x", 0)
                .attr("y", 0)
                .attr("width", width)
                .attr("height", height);
          var chartBody = svg.append("g")
                .attr("clip-path", "url(#clip)");
          for(var i=0; i < venues.length; i++)
          {
            var valueline = d3.area()
            .x(function(d) { return x(d[0]); })
            .y0(height)
            .y1(function(d) { return y(d[1][i][1]); })
            .curve(d3.curveNatural)

            chartBody.append("path")
            .data([data])
            .attr("class", "line")
            .attr("fill-opacity", 0.5 )
            .attr("fill", z(venues[i]) )
            .attr("stroke", z(venues[i]) )
            .attr("stroke-width", "2px" )
            .attr("d", valueline);
          }
        }
        else if( chartType == 2 )
        {
        
          var pie = d3.pie()
          .sort(null)
          .value(function(d) { 
            var sum = 0 ;
            for(var i = 0; i < d[1].length; i++)
              sum += d[1][i][1];
            return sum; 
          });

          var radius = Math.min(width, height) / 2;
          var path = d3.arc()
          .outerRadius(radius - 10)
          .innerRadius(0);
 
          g = svg.attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

          var arc = g.selectAll(".arc")
          .data(pie(data))
          .enter().append("g")
          .attr("class", "arc");

          arc.append("path")
          .attr("d", path)
          .attr("stroke", "#fff")
          .attr("fill", function(d) { return z(d.data[0]); });

          var label = d3.arc()
          .outerRadius(radius - 60)
          .innerRadius(radius - 60);

          arc.append("text")
          .attr("transform", function(d) { return "translate(" + label.centroid(d) + ")"; })
          .attr("dy", "0.35em")
          .text(function(d) { return d.data[0]; });

        }          
        else if( chartType == 3 )
        {
          
          var piedata = [];
          for(var i = 0 ; i < venues.length; i++)
            piedata.push( [venues[i], 0] );
         
          for(var i = 0 ; i < data.length; i++)
          {
            for(var k = 0 ; k < data[i][1].length; k++)
              piedata[ k ][1] += data[i][1][k][1];
          }
        
          var pie = d3.pie()
          .sort(null)
          .value(function(d) { return d[1] });

          var radius = Math.min(width, height) / 2;
          var path = d3.arc()
          .outerRadius(radius - 10)
          .innerRadius(0);
 
          console.log(piedata);
          
          g = svg.attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

          var arc = g.selectAll(".arc")
          .data(pie(piedata))
          .enter().append("g")
          .attr("class", "arc");

          arc.append("path")
          .attr("d", path)
          .attr("stroke", "#fff")
          .attr("fill", function(d) { return z(d.data[0]); });

          var label = d3.arc()
          .outerRadius(radius - 60)
          .innerRadius(radius - 60);

          arc.append("text")
          .attr("transform", function(d) { return "translate(" + label.centroid(d) + ")"; })
          .attr("dy", "0.35em")
          .text(function(d) { return d.data[0] + " " + d.data[1]; });
        }          
      }


      function plotTimeline()
      {
        if( timelineType == 0 )
          plotTimeline0(); 
        else if( timelineType == 1 )
          plotTimeline1(); 

      }

      function plotTimeline0()
      {
        // #timeline-container

        var margin = {top: 35, right: 25, bottom: 10, left: 120};

        var width = 860 - margin.left - margin.right, height = 600 - margin.top - margin.bottom;

        d3.select("#timeline-container svg").remove();

        var svg = d3.select("#timeline-container")
          .append("svg")
          .attr("width", width + margin.left + margin.right)
          .attr("height", height + margin.top + margin.bottom)
          .append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        // Data
        var y2p = {};
        var minX = 2100; 
        var maxX = 1900;
        var coCont = {};

        var wroteAuthor2 = wroteAuthor.slice();
        wroteAuthor2.sort( (a,b) => papers[a][4] - papers[b][4] );
        wroteAuthor2 = wroteAuthor2.slice(startTimeline, endTimeline);

        for( var i = 0; i < wroteAuthor2.length; i++)
        {     
          var y = papers[ wroteAuthor2[i] ][4];
          minX = Math.min(minX, y);
          maxX = Math.max(maxX, y);
          if( y2p[y] == undefined ) y2p[y] = [];
          y2p[y].push( wroteAuthor2[i] );
          
          for(var j = 0; j < p2w[ wroteAuthor2[i] ].length; j++)
          {
            var idCo = p2w[ wroteAuthor2[i] ][j];
            if( coCont[idCo] == undefined ) coCont[idCo] = {};
            if( coCont[idCo][y] == undefined ) coCont[idCo][y] = 0;
            coCont[idCo][y]++;
          }
        }

        var myTimeline = coCont[selectedId];
//        delete coCont[selectedId];

        var contA = [];
        for(var idA in coCont)
        {
          var sum = 0;
          for(var y in coCont[idA])
            sum += coCont[idA][y];

          contA.push([sum, parseInt(idA), coCont[idA] ]);
        }

        contA.sort( (a,b) => b[0] - a[0]);

        contA = contA.slice(0, Math.min(contA.length, 25));
        console.log(contA);
 
        var authorsNames = [""]; // , authors[selectedId][1] ];
        for(var i = 0 ; i < contA.length; i++)
        {
          authorsNames.push( authors[contA[i][1]][1] );
        }

        // X AXIS
        var x = d3.scalePoint().rangeRound([0, width]);
        x.domain(d3.range(minX, maxX+1));

        svg.append("g")
        .attr("class", "axis axis--x")
        //.attr("transform", "translate(0," + height + ")")
        .call(d3.axisTop(x))
        .selectAll("text")
        .attr("y", 10)
        .attr("x", 10)
        .attr("dy", ".35em")
        .attr("transform", "rotate(-90)")
        .style("text-anchor", "start");

        // Y AXIS
        var y = d3.scalePoint()
          .range([0, height])      
           .domain(authorsNames);

        // Z AXIS
        var z = d3.scaleOrdinal(d3.schemeCategory10);
        z.domain(authorsNames);

        svg.append("g").call(d3.axisLeft(y));

        for(var i = 0; i < contA.length; i++)
        {
          var name = authors[ contA[i][1] ][1];
          var minY = 3000;
          var maxY = 1000;
          for(var k in contA[i][2])
          {
            minY = Math.min(minY, k);
            maxY = Math.max(maxY, k);
            console.log(contA[i][0]);
            svg.append("circle")
            .attr("cx", x(k))
            .attr("cy", y(name))
            .attr("r", 5)
            .attr("stroke-width", 2)
            .attr("stroke", z(name))
            .attr("fill", z(name))
            .attr("fill-opacity", 0.5);

          }

          svg.append("line")
          .attr("x1", x(minY))
          .attr("y1", y(name))
          .attr("x2", x(maxY))
          .attr("y2", y(name))
          .attr("stroke-width", 2)
          .attr("stroke", z(name));

        }

      } 

      function plotTimeline1()
      {
        // #timeline-container
        var margin = {top: 35, right: 25, bottom: 10, left: 120};
        var width = 860 - margin.left - margin.right, height = 600 - margin.top - margin.bottom;

        d3.select("#timeline-container svg").remove();

        var svg = d3.select("#timeline-container")
          .append("svg")
          .attr("width", width + margin.left + margin.right)
          .attr("height", height + margin.top + margin.bottom)
          .append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        var xValues = [];
        var yValuesId = [];
        var yValues = [];

        var coAuth = {};

        for(var i = 0; i < wroteAuthor.length; i++)
        {
          var idP = parseInt(wroteAuthor[i]);
          xValues.push(idP);
          var wroteP = p2w[idP];
          for(var j=0; j < wroteP.length; j++)
          {
            if( coAuth[ wroteP[j] ] == undefined ) coAuth[ wroteP[j] ] = 0 ;
            coAuth[ wroteP[j] ]++ ;
          }
        }      

        xValues.sort(function(a,b){
          return papers[a][4] - papers[b][4];
        });
        
        for(var idA in coAuth ) yValuesId.push([coAuth[idA], idA]);
        yValuesId.sort( (a,b) => b[0] - a[0] );

        xValues = xValues.slice(startTimeline, endTimeline);
        yValues = yValuesId.slice(0, 25);
        for(var i = 0; i < yValues.length; i++)
          yValues[i] = authors[yValues[i][1]][1];

        // X AXIS
        var x = d3.scalePoint().range([0, width]).domain(xValues);

        // Y AXIS
        var y = d3.scalePoint().range([0, height]).domain(yValues);

        // Z AXIS
        var z = d3.scaleOrdinal(d3.schemeCategory10);
        z.domain(xValues);

        svg.append("g").call(d3.axisLeft(y));
        svg.append("g").call(d3.axisTop(x));

        for(var i = 0 ; i < yValues.length; i++)
        {
          var idA = parseInt(yValuesId[i][1]);
        
          var minJ = -1;
          var maxJ = -1;

          for(var j=0; j < xValues.length; j++)
          {
            var idP = parseInt(xValues[j]);
            console.log(idA, idP);
            if( p2w[idP].indexOf(idA) == -1 ) continue;

            maxJ = j;
            minJ = (minJ == -1) ? j : minJ;

            svg.append("circle")
            .attr("cx", x(xValues[j]))
            .attr("cy", y(yValues[i]))
            .attr("r", 5)
            .attr("stroke-width", 2)
            .attr("stroke", z(xValues[j]))
            .attr("fill", z(xValues[j]))
            .attr("fill-opacity", 0.3);

            svg.append("line")
            .attr("x1", x(xValues[j]))
            .attr("y1", y(yValues[0]))
            .attr("x2", x(xValues[j]))
            .attr("y2", y(yValues[i]))
            .attr("stroke-width", 2)
            .attr("stroke", z(xValues[j]));

          }
        }

        return ;

        for(var i = 0; i < contA.length; i++)
        {
          var name = authors[ contA[i][1] ][1];
          var minY = 3000;
          var maxY = 1000;
          for(var k in contA[i][2])
          {
            minY = Math.min(minY, k);
            maxY = Math.max(maxY, k);

            svg.append("circle")
            .attr("cx", x(k))
            .attr("cy", y(name))
            .attr("r", 5)
            .attr("stroke-width", 2)
            .attr("stroke", z(name))
            .attr("fill", z(name))
            .attr("fill-opacity", 0.5);

          }

          svg.append("line")
          .attr("x1", x(minY))
          .attr("y1", y(name))
          .attr("x2", x(maxY))
          .attr("y2", y(name))
          .attr("stroke-width", 2)
          .attr("stroke", z(name));

        }

      } 


    </script>

  </body>

  </html>
